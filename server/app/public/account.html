<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="uft-8">
        <meta name="viewport" content="width=device-width">
        <title>My Account</title>
        <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css">
        <link href="stylesheets/account.css" rel="stylesheet" type="text/css" />
        <link href="stylesheets/style.css" rel="stylesheet" type="text/css" />
        <script type="text/javascript" src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
        <script src="./javascripts/script.js"></script>
        <script src="javascripts/account.js"></script>
        <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>   <!--Chart.js for graph displays-->
    </head>
    <body>
        <div id="containerContent">
            <div id="banner">
				<div id="header">
					<a href="index.html" id="header">Heart Rate Monitoring</a>
				</div>
				
                <div id="links">
                    <a href="reference.html">References</a> <!--TODO-->
                    <a href="signup.html">Sign Up</a>
                    <a href="login.html">Login</a>
                    <a href="account.html">My&nbspAccount</a> <!--TODO, remove from home, sign up, login pages after made-->
                    <a href="physician.html">Physician</a> <!--TODO, remove from home, sign up, login pages after made-->
                </div>
            </div>
                <div id="account">
                    <h1>Account Information</h1>
                    <h2>Add or Remove Particle Board</h2>
                    <div id="accountInfo">
                        <div class="info">
                            <label for="particleToken">Token: </label>
                            <input type="text" id="particleToken" placeholder="Enter Token" name="particleToken">
                        </div>
                        <div class="info">
                            <label for="particleID">ID: </label>
                            <input type="text" id="particleID" placeholder="Enter ID" name="particleID">
                        </div>
                    </div>
                    <p></p>
                    <button id="particleButton" class="info">Update particle board</button>
                    <h2>Change Password</h2>
                    <div id="accountInfo">
                        <div class="info">
                            <label for="newPassword">New Password: </label>
                            <input type="text" id="newPassword" placeholder="Enter a new password" name="newPassword">
                        </div>
                    </div>
                    <p></p>
                    <button id="newPasswordButton" class="info">Change Password</button>
                    <p></p>
                    <div id="accountInfo">
                        <div class="info">
                            <label for="yourPhysician">Your Physician:</label>
                            <select for="yourPhysician" id="yourPhysician">
                                <!--Need to make it show all physician account names, default to whichever is chosen-->
                                <option selected=true disabled>No Physician Chosen</option>
                                <script>
                                    let numPhysicians = 5;  //replace with physicians length
                                    let physicianHTML = "";
                                    //TODO once connected to recorded data
                                    //replace "Physician ${i}" with physicians[i] email
                                    for(let i = 0; i < numPhysicians; i++) {
                                        physicianHTML += `<option value="${i}">Physician ${i}</option>`;
                                    }
                                    document.getElementById("yourPhysician").innerHTML += physicianHTML;
                                </script>
                            </select>
                        </div>
                    </div>
                    <p></p>
                    <p></p>
                    <div id="accountInfo">
                        <div class="info">
                            <!--Need to set default values to what is currently selected on board-->
                            <label for="startTime">Start requesting measurements:</label>
                            <select name="startTime" id="startTime">
                                <option value="0">12:00AM</option>
                                <option value="1">1:00AM</option>
                                <option value="2">2:00AM</option>
                                <option value="3">3:00AM</option>
                                <option value="4">4:00AM</option>
                                <option value="5">5:00AM</option>
                                <option value="6">6:00AM</option>
                                <option value="7">7:00AM</option>
                                <option value="8">8:00AM</option>
                                <option value="9">9:00AM</option>
                                <option value="10">10:00AM</option>
                                <option value="11">11:00AM</option>
                                <option value="12">12:00PM</option>
                                <option value="13">1:00PM</option>
                                <option value="14">2:00PM</option>
                                <option value="15">3:00PM</option>
                                <option value="16">4:00PM</option>
                                <option value="17">5:00PM</option>
                                <option value="18">6:00PM</option>
                                <option value="19">7:00PM</option>
                                <option value="20">8:00PM</option>
                                <option value="21">9:00PM</option>
                                <option value="22">10:00PM</option>
                                <option value="23">11:00PM</option>
                            </select>
                        </div>
                        <div class="info">
                            <label for="endTime">Finish requesting measurements:</label>
                            <select name="endTime" id="endTime">
                                <option value="0">12:00AM</option>
                                <option value="1">1:00AM</option>
                                <option value="2">2:00AM</option>
                                <option value="3">3:00AM</option>
                                <option value="4">4:00AM</option>
                                <option value="5">5:00AM</option>
                                <option value="6">6:00AM</option>
                                <option value="7">7:00AM</option>
                                <option value="8">8:00AM</option>
                                <option value="9">9:00AM</option>
                                <option value="10">10:00AM</option>
                                <option value="11">11:00AM</option>
                                <option value="12">12:00PM</option>
                                <option value="13">1:00PM</option>
                                <option value="14">2:00PM</option>
                                <option value="15">3:00PM</option>
                                <option value="16">4:00PM</option>
                                <option value="17">5:00PM</option>
                                <option value="18">6:00PM</option>
                                <option value="19">7:00PM</option>
                                <option value="20">8:00PM</option>
                                <option value="21">9:00PM</option>
                                <option value="22">10:00PM</option>
                                <option value="23">11:00PM</option>
                            </select>
                        </div>
                        <div class="info">
                            <label for="frequency">Frequency of measurements:</label>
                            <select name="frequency" id="frequency">
                                <option value="0">Once every 5 minutes</option>
                                <option value="1">Once every 10 minutes</option>
                                <option value="2">Once every 30 minutes</option>
                                <option value="3">Once every hour</option>
                                <option value="4">Once every 2 hours</option>
                                <option value="5">Once every 4 hours</option>
                                <option value="6">Once every 6 hours</option>
                                <option value="7">Once every 12 hours</option>
                            </select>
                        </div>
                    </div>
                    <p></p>
                    <button id="saveChanges" class="info">Save Changes</button>
                    <p></p>
                    <p></p>
                    <button id="logoutButton">Logout</button>
                </div>
                <div id="summary">
                    <h2>Weekly Summary</h2> <!--average, min, max heart rate over 7 days-->
                    <div class="accountInfo">
                        <p>Over the past seven days, your heart rate has been:</p>
                        <p>Average - [TODO input value from db] bpm</p>
                        <p>Maximum - [TODO input value from db] bpm</p>
                        <p>Minimum - [TODO input value from db] bpm</p>
                    </div>
                    <h2>Daily View</h2>
                    <div class="accountInfo">
                        <label for="day">Select a day of the week:</label>
                        <select name="day" id="day" onchange="displayGraph(this.options[this.selectedIndex].value)">
                            <option id="selectDay" selected=true disabled>Select</option>
                            <option value="1">Monday</option>
                            <option value="2">Tuesday</option>
                            <option value="3">Wednesday</option>
                            <option value="4">Thursday</option>
                            <option value="5">Friday</option>
                            <option value="6">Saturday</option>
                            <option value="7">Sunday</option>
                        </select>
                        <p></p>
                        <p></p>
                        <button id="resetGraph">Choose a new date</button>
                        
                        <div id="graphContainer">
                            <canvas id="bpmGraph"></canvas>
                            <canvas id="oxyGraph"></canvas>
                        </div>
                        
                        <script>
                            var bpmChart;
                            var oxyChart;

                            document.getElementById("resetGraph").onclick = function() {
                                bpmChart.destroy();
                                oxyChart.destroy();
                                document.getElementById("day").selectedIndex=0;
                                document.getElementById("graphContainer").style.display = "none";
                            }

                            //Cannot get function to work in account.js, moved directly into account.html
                            //Chooses the data for a given day (from dropdown) Assuming bpm (and other needed values are formated like this)
                            function dayChoice(day) {
                                switch(day) {
                                    //bpm value, oxy percent;
                                    case "1": var bpm = [1, 80, 90, 70, 60, 78, 70, 70, 70, 70, 70, 70, 70, 70, 70, 70, 70, 70, 70, 70, 70, 70, 70, 70]; 
                                              var oxy = [1, 80, 90, 70, 60, 78, 70, 70, 70, 70, 70, 70, 70, 70, 70, 70, 70, 70, 70, 70, 70, 70, 70, 70];
                                              break;
                                    case "2": var bpm = [2, 80, 90, 70, 60, 78, 70, 70, 70, 70, 70, 70, 70, 70, 70, 70, 70, 70, 70, 70, 70, 70, 70, 70]; 
                                              var oxy = [2, 80, 90, 70, 60, 78, 70, 70, 70, 70, 70, 70, 70, 70, 70, 70, 70, 70, 70, 70, 70, 70, 70, 70];
                                              break;
                                    case "3": var bpm = [3, 80, 90, 70, 60, 78, 70, 70, 70, 70, 70, 70, 70, 70, 70, 70, 70, 70, 70, 70, 70, 70, 70, 70]; 
                                              var oxy = [3, 80, 90, 70, 60, 78, 70, 70, 70, 70, 70, 70, 70, 70, 70, 70, 70, 70, 70, 70, 70, 70, 70, 70];
                                              break;
                                    case "4": var bpm = [4, 80, 90, 70, 60, 78, 70, 70, 70, 70, 70, 70, 70, 70, 70, 70, 70, 70, 70, 70, 70, 70, 70, 70]; 
                                              var oxy = [4, 80, 90, 70, 60, 78, 70, 70, 70, 70, 70, 70, 70, 70, 70, 70, 70, 70, 70, 70, 70, 70, 70, 70];
                                              break;
                                    case "5": var bpm = [5, 80, 90, 70, 60, 78, 70, 70, 70, 70, 70, 70, 70, 70, 70, 70, 70, 70, 70, 70, 70, 70, 70, 70]; 
                                              var oxy = [5, 80, 90, 70, 60, 78, 70, 70, 70, 70, 70, 70, 70, 70, 70, 70, 70, 70, 70, 70, 70, 70, 70, 70];
                                              break;
                                    case "6": var bpm = [6, 80, 90, 70, 60, 78, 70, 70, 70, 70, 70, 70, 70, 70, 70, 70, 70, 70, 70, 70, 70, 70, 70, 70]; 
                                              var oxy = [6, 80, 90, 70, 60, 78, 70, 70, 70, 70, 70, 70, 70, 70, 70, 70, 70, 70, 70, 70, 70, 70, 70, 70];
                                              break;
                                    case "7": var bpm = [7, 80, 90, 70, 60, 78, 70, 70, 70, 70, 70, 70, 70, 70, 70, 70, 70, 70, 70, 70, 70, 70, 70, 70]; 
                                              var oxy = [7, 80, 90, 70, 60, 78, 70, 70, 70, 70, 70, 70, 70, 70, 70, 70, 70, 70, 70, 70, 70, 70, 70, 70];
                                              break;
                                    default: var bpm = 0; oxy = 0; break;
                                }
                                return [bpm, oxy];
                            }
                            //displays daily view graph for a given day (from dropdown)
                            function displayGraph(day) {

                                let [bpm, oxy] = dayChoice(day);
                                //some error? Shouldnt happen but just incase
                                if(bpm == 0) {
                                    console.log("no choice yet");
                                    return;
                                }

                                document.getElementById("graphContainer").style.display = "block";
                                //bpm chart
                                const ctx1 = document.getElementById('bpmGraph');
                                bpmChart = new Chart(ctx1, {
                                    type: 'line',
                                    data: {
                                        //can be replaced with times/values from board
                                        labels: ['12AM', '1AM', '2AM', '3AM', '4AM', '5AM', '6AM', '7AM', '8AM', '9AM', '10AM', '11AM', '12PM', '1PM', '2PM', '3PM', '4PM', '5PM', '6PM', '7PM', '8PM', '9PM', '10PM', '11PM'],
                                        datasets: [{
                                            label: 'Heart Rate',
                                            data: bpm,
                                            borderWidth: 1
                                        }]
                                    },
                                    options: {
                                        maintainAspectRatio: false,
                                        scales: {
                                            y: {
                                                beginAtZero: true
                                            }
                                        }
                                    }
                                });
                                //oxy chart
                                const ctx2 = document.getElementById('oxyGraph');
                                oxyChart = new Chart(ctx2, {
                                    type: 'line',
                                    data: {
                                        //can be replaced with times/values from board
                                        labels: ['12AM', '1AM', '2AM', '3AM', '4AM', '5AM', '6AM', '7AM', '8AM', '9AM', '10AM', '11AM', '12PM', '1PM', '2PM', '3PM', '4PM', '5PM', '6PM', '7PM', '8PM', '9PM', '10PM', '11PM'],
                                        datasets: [{
                                            label: 'Oxygen Saturation',
                                            data: oxy,
                                            borderWidth: 1
                                        }]
                                    },
                                    options: {
                                        maintainAspectRatio: false,
                                        scales: {
                                            y: {
                                                beginAtZero: true
                                            }
                                        }
                                    }
                                });
                            }
                        </script>
                    </div>
                </div>
            </div>
        </div>
    </body>
</html>